<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Progress Widget</title>
    <style>
        :root {
            /* --- ğŸ¨ è½»å¤å¤/å…¸é›…é…è‰²æ–¹æ¡ˆ --- */
            --bg-color: #f7f5f0;       /* ç±³è‰²çº¸å¼ èƒŒæ™¯ */
            --text-color: #4a453e;     /* æ·±è¤ç°æ–‡å­— */
            --bar-bg: #e6e2da;         /* è¿›åº¦æ¡åº•è‰²ï¼ˆæµ…å’–ï¼‰ */
            --year-fill: #7d9682;      /* å¹´è¿›åº¦ï¼šè«å…°è¿ªç»¿ */
            --month-fill: #7d9682;     /* æœˆè¿›åº¦ï¼šåŒè‰²ä¿æŒç»Ÿä¸€ï¼Œæˆ–è€…ç”¨ #c4a484 (æµ…è¤) */
            --square-filled: #c07a75;  /* æ—¬åº¦æ–¹æ ¼å®å¿ƒï¼šå¤å¤çº¢/è±†æ²™è‰² */
            --square-empty: #e6e2da;   /* æ—¬åº¦æ–¹æ ¼ç©ºå¿ƒ */
        }

        body {
            margin: 0; padding: 12px;
            font-family: "Georgia", "Times New Roman", "Songti SC", serif; /* è¡¬çº¿å­—ä½“ï¼Œä¼˜é›…æ ¸å¿ƒ */
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex; flex-direction: column; gap: 8px; /* è¡Œé—´è·ç´§å‡‘ */
            overflow: hidden;
            box-sizing: border-box;
            height: 100vh;
            justify-content: center; /* å‚ç›´å±…ä¸­ */
        }

        /* ç¬¬ä¸€è¡Œï¼šæç®€æ—¶é—´ */
        .header-time {
            font-size: 16px; /* è¾ƒå°å­—å· */
            font-weight: 700;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
            font-variant-numeric: tabular-nums; /* æ•°å­—ç­‰å®½ï¼Œé˜²æ­¢è·³åŠ¨ */
        }

        /* é€šç”¨è¡Œå¸ƒå±€ï¼š[è¿›åº¦æ¡] [æ•°å­—] */
        .row {
            display: flex;
            align-items: center;
            gap: 10px;
            height: 14px; /* é™åˆ¶é«˜åº¦ */
        }

        /* æ•°å­—æ–‡å­—æ ·å¼ */
        .stat-text {
            font-size: 12px;
            font-style: italic; /* æ–œä½“å¢åŠ å¤å¤æ„Ÿ */
            min-width: 45px; /* é¢„ç•™å®½åº¦é˜²æ­¢æŠ–åŠ¨ */
            text-align: right;
            opacity: 0.8;
        }

        /* é•¿æ¡è¿›åº¦æ¡ */
        .progress-track {
            flex-grow: 1; /* å æ»¡å‰©ä½™ç©ºé—´ */
            height: 6px;
            background-color: var(--bar-bg);
            border-radius: 3px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            border-radius: 3px;
            transition: width 0.8s ease;
        }

        /* æ—¬åº¦æ–¹æ ¼å®¹å™¨ */
        .squares-container {
            flex-grow: 1;
            display: flex;
            gap: 3px; /* æ–¹æ ¼é—´è· */
            align-items: center;
        }
        /* å°æ–¹æ ¼ */
        .square {
            height: 8px;
            width: 8px;
            background-color: var(--square-empty);
            border-radius: 1px; /* å¾®å¾®åœ†è§’ */
        }
        .square.filled {
            background-color: var(--square-filled);
        }

    </style>
</head>
<body>

    <!-- 1. æ—¶é—´ï¼š1.5 Mon 22:35 -->
    <div class="header-time" id="time-display">Loading...</div>

    <!-- 2. å¹´è¿›åº¦ï¼šæ¡ + n/365 -->
    <div class="row">
        <div class="progress-track">
            <div class="progress-fill" id="year-bar" style="background-color: var(--year-fill)"></div>
        </div>
        <div class="stat-text" id="year-text">0/365</div>
    </div>

    <!-- 3. æœˆè¿›åº¦ï¼šæ¡ + n/31 -->
    <div class="row">
        <div class="progress-track">
            <div class="progress-fill" id="month-bar" style="background-color: var(--month-fill)"></div>
        </div>
        <div class="stat-text" id="month-text">0/30</div>
    </div>

    <!-- 4. æ—¬åº¦ï¼šæ–¹æ ¼ + n/10 -->
    <div class="row">
        <div class="squares-container" id="xun-grid">
            <!-- JSç”Ÿæˆ -->
        </div>
        <div class="stat-text" id="xun-text">0/10</div>
    </div>

    <script>
        function updateWidget() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth(); 
            const date = now.getDate();
            
            // --- 1. æ ¼å¼åŒ–æ—¶é—´: 1.5 Mon 22:35 ---
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const dayName = days[now.getDay()];
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            // æœˆä»½+1 (å› ä¸ºgetMonthæ˜¯0-11)
            document.getElementById('time-display').innerText = `${month + 1}.${date} ${dayName} ${hours}:${minutes}`;

            // --- 2. å¹´è¿›åº¦ ---
            const startOfYear = new Date(year, 0, 1);
            const endOfYear = new Date(year + 1, 0, 1);
            const dayOfYear = Math.floor((now - startOfYear) / (1000 * 60 * 60 * 24)) + 1;
            const totalDaysInYear = Math.floor((endOfYear - startOfYear) / (1000 * 60 * 60 * 24));
            const yearPercent = (dayOfYear / totalDaysInYear) * 100;
            
            document.getElementById('year-bar').style.width = yearPercent + '%';
            document.getElementById('year-text').innerText = `${dayOfYear}/${totalDaysInYear}`;

            // --- 3. æœˆè¿›åº¦ ---
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const monthPercent = (date / daysInMonth) * 100;
            
            document.getElementById('month-bar').style.width = monthPercent + '%';
            document.getElementById('month-text').innerText = `${date}/${daysInMonth}`;

            // --- 4. æ—¬åº¦æ–¹æ ¼é€»è¾‘ ---
            let xunTotal = 10;
            let xunCurrent = 0;

            if (date <= 10) {
                // ä¸Šæ—¬
                xunTotal = 10;
                xunCurrent = date;
            } else if (date <= 20) {
                // ä¸­æ—¬
                xunTotal = 10;
                xunCurrent = date - 10;
            } else {
                // ä¸‹æ—¬ (å¯èƒ½æ˜¯8-11å¤©)
                xunTotal = daysInMonth - 20;
                xunCurrent = date - 20;
            }

            document.getElementById('xun-text').innerText = `${xunCurrent}/${xunTotal}`;

            // æ¸²æŸ“å°æ–¹æ ¼
            const grid = document.getElementById('xun-grid');
            grid.innerHTML = ''; // æ¸…ç©º
            for (let i = 1; i <= xunTotal; i++) {
                const square = document.createElement('div');
                square.className = 'square';
                if (i <= xunCurrent) square.classList.add('filled');
                grid.appendChild(square);
            }
        }

        updateWidget();
        setInterval(updateWidget, 1000); // æ¯ç§’åˆ·æ–°
    </script>
</body>
</html>